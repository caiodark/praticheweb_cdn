{"version":3,"sources":["webpack:///./src/app/home/home.module.ts","webpack:///./src/app/home/home.page.html","webpack:///./src/app/home/home.page.scss","webpack:///./src/app/home/home.page.ts"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;AAAyC;AACM;AACF;AACqB;AACnB;AAER;AAiBvC;IAAA;IAA6B,CAAC;IAAjB,cAAc;QAf1B,8DAAQ,CAAC;YACR,OAAO,EAAE;gBACP,4DAAY;gBACZ,0DAAW;gBACX,kEAAmB;gBACnB,0DAAW;gBACX,4DAAY,CAAC,QAAQ,CAAC;oBACpB;wBACE,IAAI,EAAE,EAAE;wBACR,SAAS,EAAE,mDAAQ;qBACpB;iBACF,CAAC;aACH;YACD,YAAY,EAAE,CAAC,mDAAQ,CAAC;SACzB,CAAC;OACW,cAAc,CAAG;IAAD,qBAAC;CAAA;AAAH;;;;;;;;;;;;ACvB3B,ivDAAivD,YAAY,2DAA2D,4BAA4B,gJ;;;;;;;;;;;ACAp1D,+DAA+D,mI;;;;;;;;;;;;;;;;;;;;;ACAK;AACF;AAEzB;AACc;AAEO;AAO9D;IAIE,kBAAqB,GAAgB,EAAU,MAAc,EAAU,EAAmB,EAAU,EAAmB;QAAlG,QAAG,GAAH,GAAG,CAAa;QAAU,WAAM,GAAN,MAAM,CAAQ;QAAU,OAAE,GAAF,EAAE,CAAiB;QAAU,OAAE,GAAF,EAAE,CAAiB;IAEvH,CAAC;IAEa,iCAAc,GAA5B;;;;gBACQ,IAAI,GAAG,IAAI,CAAC;gBAClB,IAAI,CAAC,GAAG,CAAC,YAAY,EAAE,CAAC,SAAS,CAAC;oBAC1B,IAAI,YAAC,MAAM;;;;;;wCACf,IAAI,CAAC,MAAM,GAAG,MAAM,CAAC;wCACrB,IAAI,CAAC,WAAW,GAAG,IAAI,GAAG,EAAkB,CAAC;8CAClB,EAAX,SAAI,CAAC,MAAM;;;6CAAX,eAAW;wCAAhB,CAAC;wCACE,qBAAM,IAAI,CAAC,gBAAgB,CAAC,CAAC,CAAC;;wCAApC,GAAG,GAAG,SAA8B;wCAC1C,IAAI,CAAC,WAAW,CAAC,GAAG,CAAC,CAAC,CAAC,GAAG,EAAE,GAAG,CAAC,CAAC;;;wCAFnB,IAAW;;;;;;qBAI5B;oBACD,KAAK,YAAC,GAAG;wBACP,OAAO,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;oBACnB,CAAC;iBACF,CAAC,CAAC;;;;KACJ;IAEO,mCAAgB,GAAxB,UAAyB,IAAU;QAAnC,iBAYC;QAXC,IAAM,IAAI,GAAG,IAAI,CAAC;QAClB,OAAO,IAAI,OAAO,CAAC,UAAC,OAAO,EAAE,MAAM;YACjC,KAAI,CAAC,GAAG,CAAC,kBAAkB,CAAC,IAAI,CAAC,CAAC,SAAS,CAAC;gBAC1C,IAAI,YAAC,MAAM;oBACT,OAAO,CAAC,MAAM,CAAC,CAAC;gBAClB,CAAC;gBACD,KAAK,YAAC,GAAG;oBACP,OAAO,CAAC,CAAC,CAAC,CAAC;gBACb,CAAC;aACF,CAAC,CAAC;QACL,CAAC,CAAC,CAAC;IACL,CAAC;IAED,mCAAgB,GAAhB;QACE,IAAI,CAAC,cAAc,EAAE,CAAC;IACxB,CAAC;IAED,gCAAa,GAAb;QACE,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,gBAAgB,CAAC,CAAC,CAAC;IAC3C,CAAC;IAED,8BAAW,GAAX,UAAY,EAAU;QACpB,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,YAAY,EAAE,EAAE,CAAC,CAAC,CAAC;IAC3C,CAAC;IAED,iCAAc,GAAd,UAAe,EAAU;QACvB,IAAI,CAAC,MAAM,CAAC,QAAQ,CAAC,CAAC,UAAU,EAAE,EAAE,CAAC,CAAC,CAAC;IACzC,CAAC;IAEK,+BAAY,GAAlB,UAAmB,OAAe;;;;;4BAClB,qBAAM,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC;4BACjC,OAAO;4BACP,QAAQ,EAAE,IAAI;yBACf,CAAC;;wBAHI,KAAK,GAAG,SAGZ;wBACF,qBAAM,KAAK,CAAC,OAAO,EAAE;;wBAArB,SAAqB,CAAC;;;;;KACvB;IAEK,sCAAmB,GAAzB,UAA0B,EAAU;;;;;;wBAC5B,IAAI,GAAG,IAAI,CAAC;wBACJ,qBAAM,IAAI,CAAC,EAAE,CAAC,MAAM,CAAC;gCACjC,MAAM,EAAE,uBAAuB;gCAC/B,OAAO,EAAE,kDAAkD;gCAC3D,OAAO,EAAE;oCACP;wCACE,IAAI,EAAE,SAAS;wCACf,IAAI,EAAE,QAAQ;wCACd,QAAQ,EAAE,WAAW;wCACrB,OAAO,EAAE,UAAC,GAAG,IAAM,CAAC;qCACrB;oCACD;wCACE,IAAI,EAAE,UAAU;wCAChB,OAAO,EAAE;4CACP,IAAI,CAAC,GAAG,CAAC,WAAW,CAAC,EAAE,CAAC,CAAC,SAAS,CAAC;gDAC3B,IAAI,YAAC,MAAM;;;4DACf,IAAI,MAAM,KAAK,yEAAa,CAAC,EAAE,EAAE;gEAC/B,IAAI,CAAC,cAAc,EAAE,CAAC;gEACtB,IAAI,CAAC,YAAY,CAAC,kCAAkC,CAAC,CAAC;6DACvD;iEAAM;gEACL,IAAI,CAAC,YAAY,CAAC,yCAAyC,CAAC,CAAC;6DAC9D;;;;iDACF;gDACK,KAAK,YAAC,GAAG;;;4DACb,IAAI,CAAC,YAAY,CAAC,0BAAwB,GAAK,CAAC,CAAC;;;;iDAClD;6CACF,CAAC,CAAC;wCACL,CAAC;qCACF;iCACF;6BACF,CAAC;;wBA7BI,KAAK,GAAG,SA6BZ;wBACF,qBAAM,KAAK,CAAC,OAAO,EAAE;;wBAArB,SAAqB,CAAC;;;;;KACvB;IAEK,+BAAY,GAAlB,UAAmB,EAAU;;;;4BAC3B,qBAAM,IAAI,CAAC,mBAAmB,CAAC,EAAE,CAAC;;wBAAlC,SAAkC,CAAC;;;;;KACpC;IAnGQ;QAAR,2DAAK,EAAE;wEAAS,KAAK;4CAAO;IACpB;QAAR,2DAAK,EAAE;wEAAc,GAAG;iDAAiB;IAF/B,QAAQ;QALpB,+DAAS,CAAC;YACT,QAAQ,EAAE,UAAU;YACpB,sFAA6B;;SAE9B,CAAC;+EAK0B,kEAAW,EAAkB,sDAAM,EAAc,8DAAe,EAAc,8DAAe;OAJ5G,QAAQ,CAqGpB;IAAD,eAAC;CAAA;AArGoB","file":"home-home-module.js","sourcesContent":["import { NgModule } from '@angular/core';\nimport { CommonModule } from '@angular/common';\nimport { IonicModule } from '@ionic/angular';\nimport { FormsModule, ReactiveFormsModule } from '@angular/forms';\nimport { RouterModule } from '@angular/router';\n\nimport { HomePage } from './home.page';\n\n@NgModule({\n  imports: [\n    CommonModule,\n    FormsModule,\n    ReactiveFormsModule,\n    IonicModule,\n    RouterModule.forChild([\n      {\n        path: '',\n        component: HomePage\n      }\n    ])\n  ],\n  declarations: [HomePage]\n})\nexport class HomePageModule {}\n","module.exports = \"<ion-header>\\n  <ion-toolbar>\\n    <ion-buttons slot=\\\"start\\\">\\n      <ion-menu-button icon-only menuToggle=\\\"start\\\">\\n          <ion-icon name=\\\"menu\\\"></ion-icon>\\n      </ion-menu-button>          \\n    </ion-buttons>\\n    <ion-title>\\n          Pratiche Web\\n    </ion-title>\\n  </ion-toolbar>\\n</ion-header>\\n<ion-content>\\n  <div class=\\\"ion-padding\\\">\\n    <div>\\n      <h1>Opzioni per cliente</h1>\\n    </div>\\n    <div *ngIf=\\\"!kinds$ || kinds$.length === 0\\\">\\n      Nessun tipo opzione presente <br />\\n      <ion-button color=\\\"tertiary\\\" (click)=\\\"onCreateClick()\\\" size=\\\"default\\\">\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"create\\\"></ion-icon>\\n      </ion-button>\\n    </div>\\n    <div *ngIf=\\\"kinds$ && kinds$.length > 0\\\">\\n      <ion-button color=\\\"tertiary\\\" (click)=\\\"onCreateClick()\\\" size=\\\"default\\\">\\n        <ion-icon slot=\\\"icon-only\\\" name=\\\"create\\\"></ion-icon>\\n      </ion-button>\\n    </div>\\n    <ion-grid *ngIf=\\\"kinds$ && kinds$.length > 0\\\">\\n      <ion-row>\\n        <ion-col size=\\\"12\\\" size-sm>\\n          <ion-list>\\n            <ion-item *ngFor=\\\"let kind$ of kinds$\\\" lines=\\\"full\\\" >\\n              <ion-button color=\\\"primary\\\" (click)=\\\"onItemClick(kind$._id)\\\" slot=\\\"start\\\">\\n                <ion-icon slot=\\\"icon-only\\\" name=\\\"compass\\\"></ion-icon>\\n              </ion-button>\\n              <ion-button color=\\\"secondary\\\" slot=\\\"start\\\" (click)=\\\"onOptionsClick(kind$._id)\\\">\\n                <ion-icon slot=\\\"icon-only\\\" name=\\\"list\\\"></ion-icon>\\n              </ion-button>\\n              <ion-button color=\\\"danger\\\" slot=\\\"end\\\" (click)=\\\"onItemDelete(kind$._id)\\\">\\n                <ion-icon slot=\\\"icon-only\\\" name=\\\"trash\\\"></ion-icon>\\n              </ion-button>\\n              <ion-label>{{kind$.name}}</ion-label>\\n              <ion-badge color=\\\"primary\\\">{{kindsBadge$.get(kind$._id)}}</ion-badge>\\n            </ion-item>\\n          </ion-list>\\n        </ion-col>\\n      </ion-row>\\n    </ion-grid>\\n  </div>\\n</ion-content>\\n\"","module.exports = \"\\n/*# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IiIsImZpbGUiOiJzcmMvYXBwL2hvbWUvaG9tZS5wYWdlLnNjc3MifQ== */\"","import { Component, OnInit, OnDestroy, Input } from '@angular/core';\nimport { AlertController, ToastController } from '@ionic/angular';\nimport { Subscription } from 'rxjs';\nimport { Router } from '@angular/router';\nimport { KindService } from '../services/kind.service';\nimport { Kind } from '../models/kind';\nimport { ServiceStatus } from '../models/service-status.enum';\n\n@Component({\n  selector: 'app-home',\n  templateUrl: 'home.page.html',\n  styleUrls: ['home.page.scss'],\n})\nexport class HomePage {\n  @Input() kinds$: Array<Kind>;\n  @Input() kindsBadge$: Map<string, number>;\n\n  constructor( private _ks: KindService, private router: Router, private ac: AlertController, private tc: ToastController) {\n\n  }\n\n  private async updateKindList() {\n    const self = this;\n    this._ks.asyncGetList().subscribe({\n      async next(result) {\n        self.kinds$ = result;\n        self.kindsBadge$ = new Map<string, number>();\n        for (const k of self.kinds$) {\n          const sum = await self.updateKindBadges(k);\n          self.kindsBadge$.set(k._id, sum);\n        }\n      },\n      error(err) {\n        console.log(err);\n      }\n    });\n  }\n\n  private updateKindBadges(kind: Kind):Promise<number> {\n    const self = this;\n    return new Promise((resolve, reject) => {\n      this._ks.asyncGetSumOptions(kind).subscribe({\n        next(result) {\n          resolve(result);\n        },\n        error(err) {\n          resolve(0);\n        }\n      });\n    });\n  }\n\n  ionViewWillEnter() {\n    this.updateKindList();\n  }\n\n  onCreateClick() {\n    this.router.navigate(['/kind-form/new']);\n  }\n\n  onItemClick(id: String) {\n    this.router.navigate(['/kind-form', id]);\n  }\n\n  onOptionsClick(id: string) {\n    this.router.navigate(['/options', id]);\n  }\n\n  async presentToast(message: string) {\n    const toast = await this.tc.create({\n      message,\n      duration: 2000\n    });\n    await toast.present();\n  }\n\n  async presentAlertConfirm(id: String) {\n    const self = this;\n    const alert = await this.ac.create({\n      header: 'Cancellazione opzione',\n      message: 'Stai per <strong>cancellare</strong> una opzione',\n      buttons: [\n        {\n          text: 'Annulla',\n          role: 'cancel',\n          cssClass: 'secondary',\n          handler: (cnl) => {}\n        },\n        {\n          text: 'Conferma',\n          handler: () => {\n            self._ks.asyncDelete(id).subscribe({\n              async next(result) {\n                if (result === ServiceStatus.OK) {\n                  self.updateKindList();\n                  self.presentToast('Opzione cancellata correttamente');\n                } else {\n                  self.presentToast('Si Ã¨ presentato un problema, riprovare!');\n                }\n              },\n              async error(err) {\n                self.presentToast(`Riscontrato problema ${err}`);\n              }\n            });\n          }\n        }\n      ]\n    });\n    await alert.present();\n  }\n\n  async onItemDelete(id: String) {\n    await this.presentAlertConfirm(id);\n  }\n}\n"],"sourceRoot":""}